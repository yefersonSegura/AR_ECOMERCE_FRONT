<div class="grid card">
    <div class="col-12 md:col-12 layout-main-content-header">
        <h5>
            Categoria
        </h5>
    </div>
    <div class="col-12 md:col-12">
        <p-toolbar>
            <div class="p-toolbar-group-left">
                <button pButton type="button" label="Nuevo" icon="fa fa-floppy-o" class="p-button-link mr:col-2"
                    (click)="visible=true;"></button>
            </div>
        </p-toolbar>
    </div>
    <div class="col-12 md:col-12 mt-3">
        <p-table [value]="categories" [columns]="cols" styleClass="p-datatable-sm" [paginator]="false" [lazy]="false"
            [loading]="loading" [responsive]="true" scrollHeight="460px" [scrollable]="true" dataKey="categoryID"
            [tableStyle]="{ 'min-width': '50rem' }">
            <ng-template pTemplate="header" let-columns>
                <tr>
                    @for(col of columns;track col.field){
                    <th
                        [ngStyle]="{'text-align':col.align,'width':col.width,'display': col.display,'min-width':col.minWidth, 'max-width':col.maxWidth}">
                        {{col.header}}
                    </th>
                    }
                    <th style="width: 150px;">
                        Acciones
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr [pSelectableRow]="rowData">
                    @for(col of columns;track col?.id){
                    <td class="table-cell-word-wrap"
                        [ngStyle]="{'text-align':col.align, 'width':col.width,'display':col.display,'min-width':col.minWidth, 'max-width':col.maxWidth}">
                        @if(!( col.type === 'date'|| col.type === 'serie'|| col.type === 'money')){
                        <span>
                            {{rowData[col.field]}}
                        </span>
                        }
                        @if(col.type === 'date'){
                        <span>
                            {{rowData[col.field] | date:col.format}}
                        </span>
                        }
                    </td>
                    }
                    <td style="width: 150px; display: flex;">
                        <p-button icon="fa fa-edit" [rounded]="true" severity="success" [outlined]="true" class="ml-2"
                            (click)="removeEdit(rowData)" />
                        <p-button icon="fa fa-trash" [rounded]="true" class="ml-2" severity="danger" [outlined]="true"
                            (click)="removeRow(rowData)" />
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>

<p-dialog header="Nueva Categoria" [modal]="true" [(visible)]="visible" [style]="{ width: '30rem' }">
    <span class="p-text-secondary block mb-5">Complete todos los campos.</span>
    <div class="col-12 md:col-12 mt-5">
        <div class="p-fluid grid formgrid">
            <div class="col-12 md:col-4 p-field">
                Nombre:
            </div>
            <div class="col-12 md:col-8 p-field">
                <input pInputText id="firstName" class="flex-auto" [(ngModel)]="categoryModel.categoryName" />
                <small class="p-error" *ngIf="submitted && !categoryModel.categoryName">Campo requerido</small>
            </div>
            <div class="col-12 md:col-4 p-field mt-2">
                Descripci√≥n:
            </div>
            <div class="col-12 md:col-8 p-field mt-2">
                <input pInputText id="firstName" class="flex-auto" [(ngModel)]="categoryModel.description" />
                <small class="p-error" *ngIf="submitted && !categoryModel.description">Campo requerido</small>
            </div>
        </div>
    </div>
    <ng-template pTemplate="footer">
        <p-button label="Guardar" [outlined]="true" severity="secondary" (onClick)="saveCategories()" />
        <p-button label="Cancelar" [text]="true" severity="secondary" (onClick)="visible = false" />
    </ng-template>
  </p-dialog>